<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Profile</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
</head>
<body>
<div class="profile-container">

    <!-- Profile Image -->
    {% if user_profile.profile_picture %}
        <img src="{{ user_profile.profile_picture.url }}" alt="Profile picture" class="profile-img">
    {% else %}
        <img src="https://via.placeholder.com/150" alt="No Profile Image" class="profile-img">
    {% endif %}

    <!-- User Info -->
    <h2>{{ user_profile.username }}</h2>
    <p>{{ user_profile.email }}</p>

    <!-- Follow / Unfollow Button -->
    {% if logged_in_user_id and logged_in_user_id.user_id != user_profile.user_id %}
        <form method="post" action="{% url 'toggle_follow' user_profile.user_id %}" class="follow-btn">
            {% csrf_token %}
            {% if is_following %}
                <button type="submit">Unfollow</button>
            {% else %}
                <button type="submit">Follow</button>
            {% endif %}
        </form>
    {% endif %}

    <!-- Stats with Links -->
    <div class="stats">
        <a href="{% url 'followers_list' user_profile.user_id %}">
            <strong>{{ user_profile.followers.count }}</strong> Followers
        </a>
        <a href="{% url 'following_list' user_profile.user_id %}">
            <strong>{{ user_profile.following.count }}</strong> Following
        </a>
    </div>

    <!-- Edit Profile (only if current user is owner) -->
    {% if logged_in_user_id and logged_in_user_id.user_id == user_profile.user_id %}
        <div class="edit-link">
            <a href="{% url 'edit_profile' %}">Edit Profile</a>
        </div>
    {% endif %}

    <!-- User Posts -->
    <div class="posts">
        <h3>{{ user_profile.username }}'s Posts</h3>
        {% if posts %}
            {% for post in posts %}
                <div class="post">
                    <p>{{ post.content }}</p>
                    {% if post.media %}
                        <img src="{{ post.media.url }}" alt="Post media" class="post-img">
                    {% endif %}
                    <small>Posted on {{ post.created_at|date:"M d, Y H:i" }}</small>
                </div>
            {% endfor %}
        {% else %}
            <p>No posts yet.</p>
        {% endif %}
    </div>

</div>
</body>
</html>
